'use strict';function b(c,d){const e=a();return b=function(f,g){f=f-0x153;let h=e[f];return h;},b(c,d);}const I=b,J=b;(function(c,d){const G=b,H=b,e=c();while(!![]){try{const f=-parseInt(G(0x162))/0x1+parseInt(G(0x169))/0x2*(-parseInt(G(0x171))/0x3)+parseInt(G(0x17b))/0x4*(-parseInt(G(0x153))/0x5)+-parseInt(H(0x15a))/0x6+parseInt(H(0x160))/0x7+parseInt(H(0x154))/0x8+parseInt(H(0x156))/0x9;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xf387b));var __createBinding=this&&this[I(0x159)]||(Object[J(0x161)]?function(c,d,e,f){const K=J,L=I;if(f===undefined)f=e;var g=Object[K(0x163)](d,e);(!g||(L(0x164)in g?!d[K(0x179)]:g[K(0x17f)]||g[L(0x177)]))&&(g={'enumerable':!![],'get':function(){const M=K,N=L;if('MkPsF'===M(0x178))return d[e];else throw new e[(N(0x173))](f['message']);}}),Object['defineProperty'](c,f,g);}:function(c,d,e,f){if(f===undefined)f=e;c[f]=d[e];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[I(0x161)]?function(c,d){const O=I;Object[O(0x15e)](c,'default',{'enumerable':!![],'value':d});}:function(c,d){c['default']=d;}),__importStar=this&&this[I(0x15d)]||function(c){const P=J,Q=J;if(c&&c[P(0x179)])return c;var d={};if(c!=null){for(var e in c)if(e!==Q(0x173)&&Object[P(0x158)][P(0x168)][Q(0x17e)](c,e))__createBinding(d,c,e);}return __setModuleDefault(d,c),d;},__importDefault=this&&this[I(0x165)]||function(c){const R=I;return c&&c[R(0x179)]?c:{'default':c};};Object[I(0x15e)](exports,'__esModule',{'value':!![]}),exports['sendMessageAPI']=void 0x0;function a(){const U=['gKbwF','8186521aJrTYy','create','166936GbocHO','getOwnPropertyDescriptor','get','__importDefault','body','UdhOk','hasOwnProperty','680528IJmmmr','url','string','yup','APIAuth','shape','object','Message\x20add\x20queue','3FuAgLA','findOne','default','number','file','../errors/AppError','configurable','MkPsF','__esModule','params','875660QmDnId','ndQSQ','sessionId','call','writable','nullable','../libs/Queue','30ziRstx','11441192CjLhhJ','required','16217028xZaHsp','../models/ApiConfig','prototype','__createBinding','9500130hUGETN','status','sendMessageAPI','__importStar','defineProperty'];a=function(){return U;};return a();}const Yup=__importStar(require(J(0x16c))),AppError_1=__importDefault(require(I(0x176))),ApiConfig_1=__importDefault(require(J(0x157))),Queue_1=__importDefault(require(I(0x181))),sendMessageAPI=async(c,d)=>{const S=J,T=J,{tenantId:e,sessionId:f}=c[S(0x16d)],{apiId:g}=c[T(0x17a)],h=c[T(0x175)],i=await ApiConfig_1[T(0x173)][S(0x172)]({'where':{'id':g,'tenantId':e}});if(i?.[T(0x17d)]!==f){if(S(0x15f)!==T(0x17c))throw new AppError_1[(T(0x173))]('ERR_SESSION_NOT_AUTH_TOKEN',0x193);else f[S(0x15e)](g,S(0x173),{'enumerable':!![],'value':h});}const j={...c[S(0x166)],'apiId':g,'sessionId':f,'tenantId':e,'apiConfig':i,'media':h},k=Yup[T(0x16f)]()[S(0x16e)]({'apiId':Yup[S(0x16b)](),'sessionId':Yup[S(0x174)](),'body':Yup[S(0x16b)]()[T(0x155)](),'number':Yup[T(0x16b)]()[T(0x155)](),'mediaUrl':Yup[T(0x16b)]()[T(0x16a)]()[S(0x180)]()||Yup[T(0x16f)]()['shape']({'destination':Yup[T(0x16b)]()['required'](),'encoding':Yup[S(0x16b)]()[S(0x155)](),'fieldname':Yup['string']()[T(0x155)](),'filename':Yup[T(0x16b)]()['required'](),'mimetype':Yup[T(0x16b)]()[S(0x155)](),'originalname':Yup[S(0x16b)]()['required'](),'path':Yup[T(0x16b)]()[S(0x155)](),'size':Yup['number']()[S(0x155)]()}),'externalKey':Yup['string']()['required'](),'tenantId':Yup[T(0x174)]()[T(0x155)]()});try{await k['validate'](j);}catch(m){if(T(0x167)!==T(0x167))e[S(0x173)]=f;else throw new AppError_1[(S(0x173))](m['message']);}return Queue_1[S(0x173)]['add']('SendMessageAPI',j),d[S(0x15b)](0xc8)['json']({'message':S(0x170)});};exports[J(0x15c)]=sendMessageAPI;