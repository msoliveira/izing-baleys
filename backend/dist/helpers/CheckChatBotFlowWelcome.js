'use strict';const o=b,q=b;(function(c,d){const m=b,n=b,e=c();while(!![]){try{const f=parseInt(m(0x8a))/0x1*(-parseInt(n(0x88))/0x2)+-parseInt(m(0x74))/0x3+parseInt(m(0x83))/0x4*(parseInt(n(0x75))/0x5)+-parseInt(m(0x82))/0x6*(-parseInt(n(0x7a))/0x7)+parseInt(m(0x70))/0x8*(-parseInt(m(0x76))/0x9)+-parseInt(m(0x80))/0xa+parseInt(m(0x7c))/0xb;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x22465));function b(c,d){const e=a();return b=function(f,g){f=f-0x70;let h=e[f];return h;},b(c,d);}function a(){const t=['7953011XpWUKI','../services/WhatsappService/ShowWhatsAppService','chatBot','../models/Setting','1973120GRYNMO','tenantId','30bjPCfe','796TNJQDq','from','../models/ChatFlow','lineList','userId','365896nLfGLt','default','1bXWYYg','848cXCuEx','whatsappId','channel','find','806409RPTnfO','1135jJdUPd','16128mZkNYO','start','contactId','__importDefault','295722IqfaAJ','__esModule'];a=function(){return t;};return a();}var __importDefault=this&&this[o(0x79)]||function(c){const p=o;return c&&c[p(0x7b)]?c:{'default':c};};Object['defineProperty'](exports,o(0x7b),{'value':!![]});const Contact_1=__importDefault(require('../models/Contact')),Setting_1=__importDefault(require(o(0x7f))),ChatFlow_1=__importDefault(require(q(0x85))),CreateLogTicketService_1=__importDefault(require('../services/TicketServices/CreateLogTicketService')),IsContactTest_1=__importDefault(require('../services/ChatFlowServices/IsContactTest')),ShowWhatsAppService_1=__importDefault(require(q(0x7d))),CheckChatBotFlowWelcome=async c=>{const r=o,s=o;if(c[r(0x87)]||c['isGroup'])return;const d=await Setting_1['default']['findOne']({'where':{'key':'botTicketActive','tenantId':c[s(0x81)]}}),e=await(0x0,ShowWhatsAppService_1[s(0x89)])({'id':c[r(0x71)],'tenantId':c[r(0x81)]}),f=e?.['chatFlowId']||d?.['value'];if(!f)return;const g=await ChatFlow_1['default']['findOne']({'where':{'id':+f,'tenantId':c[r(0x81)],'isActive':!![],'isDeleted':![]}});if(!g)return;const h=await Contact_1[s(0x89)]['findByPk'](c[s(0x78)]),{celularTeste:i}=g,j=h?.['number'];if(await(0x0,IsContactTest_1[r(0x89)])(j,i,c[r(0x72)]))return;const k=g['flow'][s(0x86)][r(0x73)](l=>l[s(0x84)]===r(0x77));await c['update']({'chatFlowId':g['id'],'stepChatFlow':k['to'],'lastInteractionBot':new Date()}),await(0x0,CreateLogTicketService_1[r(0x89)])({'ticketId':c['id'],'type':r(0x7e)});};exports['default']=CheckChatBotFlowWelcome;