'use strict';const q=b,r=b;(function(c,d){const o=b,p=b,e=c();while(!![]){try{const f=-parseInt(o(0x15a))/0x1*(parseInt(p(0x175))/0x2)+-parseInt(o(0x160))/0x3+parseInt(p(0x174))/0x4+parseInt(o(0x163))/0x5*(-parseInt(p(0x155))/0x6)+parseInt(o(0x159))/0x7+-parseInt(p(0x152))/0x8*(parseInt(o(0x16d))/0x9)+parseInt(o(0x14c))/0xa;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xd46ad));function a(){const u=['differenceInHours','../models/Message','createdAt','dataJson','6047164PAvYkT','392538JnriXJ','../errors/AppError','__esModule','37907540dvDspC','whatsapp','findOne','date-fns','../libs/socket','../libs/tbot','2152iFCJMc','key','contact','1164lHyryW','remoteJid','WDzVe','parseJSON','8670165MpKnRr','8OFlKft','deleteMessage','getIO','../models/Ticket','emit','No\x20delete\x20message\x20afeter\x202h\x20sended','2845299pOMBoc','../libs/wbot-baileys','telegram','43160hirBMA','whatsappId','tenant:',':appMessage','defineProperty','ticket','instagram','messageId','getWbot','default','49446mRPdyi','channel','update'];a=function(){return u;};return a();}function b(c,d){const e=a();return b=function(f,g){f=f-0x14a;let h=e[f];return h;},b(c,d);}var __importDefault=this&&this['__importDefault']||function(c){return c&&c['__esModule']?c:{'default':c};};Object[q(0x167)](exports,q(0x14b),{'value':!![]});const date_fns_1=require(q(0x14f)),Message_1=__importDefault(require(r(0x171))),Ticket_1=__importDefault(require(r(0x15d))),tbot_1=require(r(0x151)),AppError_1=__importDefault(require(r(0x14a))),socket_1=require(r(0x150)),wbot_baileys_1=require(r(0x161)),DeleteMessageSystem=async(c,d,e)=>{const s=r,t=r,f=await Message_1[s(0x16c)][s(0x14e)]({'where':{'id':c},'include':[{'model':Ticket_1[t(0x16c)],'as':t(0x168),'include':[t(0x154)],'where':{'tenantId':e}}]});if(f){if(t(0x157)===t(0x157)){const i=(0x0,date_fns_1[s(0x170)])(new Date(),(0x0,date_fns_1[t(0x158)])(f?.[s(0x172)]));if(i>0x2)throw new AppError_1[(s(0x16c))](s(0x15f));}else return;}if(!f)throw new AppError_1[(t(0x16c))]('No\x20message\x20found\x20with\x20this\x20ID.');const {ticket:g}=f;if(g[t(0x16e)]===s(0x14d)){const k=await(0x0,wbot_baileys_1[t(0x16b)])(g[t(0x164)]),l=JSON['parse'](f[s(0x173)]);await k['sendMessage'](l[s(0x153)][s(0x156)],{'delete':l[t(0x153)]});}if(g[t(0x16e)]===s(0x162)){const m=await(0x0,tbot_1['getTbot'])(g[t(0x164)]);await m[s(0x162)][t(0x15b)](g[s(0x154)]['telegramId'],+f[t(0x16a)]);}if(g['channel']===t(0x169))return;if(g[s(0x16e)]==='messenger')return;await f[s(0x16f)]({'isDeleted':!![]});const h=(0x0,socket_1[s(0x15c)])();h['to'](t(0x165)+e+':'+g['id'])[s(0x15e)](s(0x165)+e+t(0x166),{'action':t(0x16f),'message':f,'ticket':g,'contact':g['contact']});};exports['default']=DeleteMessageSystem;