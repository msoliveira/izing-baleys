'use strict';const s=b,t=b;(function(c,d){const q=b,r=b,e=c();while(!![]){try{const f=-parseInt(q(0x140))/0x1*(-parseInt(r(0x155))/0x2)+-parseInt(q(0x141))/0x3+parseInt(r(0x156))/0x4+parseInt(r(0x157))/0x5*(-parseInt(r(0x13d))/0x6)+-parseInt(q(0x149))/0x7*(-parseInt(r(0x146))/0x8)+parseInt(r(0x13a))/0x9+-parseInt(r(0x142))/0xa*(parseInt(r(0x144))/0xb);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xba4f7));function a(){const G=['3915135QxxfVr','logger','publish','5288214oBlzIf','error','consume','61uKuvDB','2105592NWaKos','5781470NIkUog','connect','11QUaTJc','assertQueue','8UIqSLL','consumeWhatsapp','conn','9867067YeHSFu','publishInQueue','nack','env','../utils/logger','start','WccVO','sleepRandomTime','from','amqplib','ack','channel','1552QkIMNM','4130300VYEbFo','5pGWiUe','prefetch','uri'];a=function(){return G;};return a();}function b(c,d){const e=a();return b=function(f,g){f=f-0x13a;let h=e[f];return h;},b(c,d);}Object['defineProperty'](exports,'__esModule',{'value':!![]});const amqplib_1=require(s(0x152)),logger_1=require(t(0x14d)),sleepRandomTime_1=require('../utils/sleepRandomTime');class RabbitmqServer{constructor(c){const u=s;this[u(0x159)]=c;}async[s(0x14e)](){const v=t,w=t;this[v(0x148)]=await(0x0,amqplib_1[w(0x143)])(this[v(0x159)]),this[w(0x154)]=await this[v(0x148)]['createChannel'](),await this[w(0x154)]['assertQueue']('waba360',{'durable':!![]}),await this[v(0x154)]['assertQueue']('messenger',{'durable':!![]});}async[s(0x14a)](c,d){const x=s,y=t;return await this[x(0x154)][y(0x145)](c,{'durable':!![]}),this['channel']['sendToQueue'](c,Buffer[x(0x151)](d),{'persistent':!![]});}async['publishInExchange'](c,d,e){const z=t,A=s;return this[z(0x154)][z(0x13c)](c,d,Buffer[A(0x151)](e),{'persistent':!![]});}async[t(0x147)](c,d){const B=t,C=t;this[B(0x154)][B(0x158)](0xa,![]),await this[B(0x154)][B(0x145)](c,{'durable':!![]}),this['channel']['consume'](c,async e=>{const D=B,E=B;try{if(D(0x14f)!==D(0x14f)){f(g),this['channel'][E(0x153)](h);return;}else{await d(e),await(0x0,sleepRandomTime_1[E(0x150)])({'minMilliseconds':Number(process[E(0x14c)]['MIN_SLEEP_INTERVAL']||0x1f4),'maxMilliseconds':Number(process[E(0x14c)]['MAX_SLEEP_INTERVAL']||0x7d0)}),this['channel']['ack'](e);return;}}catch(g){this[D(0x154)][D(0x14b)](e),logger_1[D(0x13b)][E(0x13e)](E(0x147),g);}});}async[s(0x13f)](c,d){return this['channel']['consume'](c,e=>{const F=b;try{d(e),this['channel']['ack'](e);return;}catch(f){logger_1[F(0x13b)]['error'](f);}});}}exports['default']=RabbitmqServer;