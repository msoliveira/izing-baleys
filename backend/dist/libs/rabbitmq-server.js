'use strict';const t=b,u=b;(function(c,d){const r=b,s=b,e=c();while(!![]){try{const f=-parseInt(r(0x1af))/0x1+parseInt(r(0x1b4))/0x2*(parseInt(s(0x1ac))/0x3)+-parseInt(s(0x1ad))/0x4*(parseInt(s(0x19b))/0x5)+parseInt(s(0x1a1))/0x6+parseInt(r(0x1b3))/0x7+-parseInt(s(0x1b5))/0x8*(-parseInt(r(0x199))/0x9)+-parseInt(r(0x1a8))/0xa;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x736a4));function a(){const L=['uri','createChannel','connect','5389860ndvAzf','1219194XsqXAC','1316824ZSoVlH','assertQueue','nack','env','__esModule','defineProperty','amqplib','from','18RvFXrc','publish','3398095HFiJqb','kySSI','publishInExchange','error','sendToQueue','start','534906Ewbwvg','conn','MAX_SLEEP_INTERVAL','sleepRandomTime','prefetch','logger','MIN_SLEEP_INTERVAL','217420FSJXfC','ack','channel','consumeWhatsapp','3EfKAoB','4cAmuEZ','consume','623833NfYQiC'];a=function(){return L;};return a();}Object[t(0x196)](exports,u(0x195),{'value':!![]});function b(c,d){const e=a();return b=function(f,g){f=f-0x194;let h=e[f];return h;},b(c,d);}const amqplib_1=require(u(0x197)),logger_1=require('../utils/logger'),sleepRandomTime_1=require('../utils/sleepRandomTime');class RabbitmqServer{constructor(c){const v=t;this[v(0x1b0)]=c;}async[t(0x1a0)](){const w=u,x=t;this[w(0x1a2)]=await(0x0,amqplib_1[x(0x1b2)])(this[w(0x1b0)]),this[w(0x1aa)]=await this[w(0x1a2)][w(0x1b1)](),await this[x(0x1aa)][x(0x1b6)]('waba360',{'durable':!![]}),await this['channel']['assertQueue']('messenger',{'durable':!![]});}async['publishInQueue'](c,d){const y=u,z=u;return await this[y(0x1aa)][z(0x1b6)](c,{'durable':!![]}),this[z(0x1aa)][z(0x19f)](c,Buffer[z(0x198)](d),{'persistent':!![]});}async[t(0x19d)](c,d,e){const A=t,B=u;return this[A(0x1aa)][A(0x19a)](c,d,Buffer['from'](e),{'persistent':!![]});}async[u(0x1ab)](c,d){const C=u,D=t;this[C(0x1aa)][D(0x1a5)](0xa,![]),await this[C(0x1aa)]['assertQueue'](c,{'durable':!![]}),this[C(0x1aa)][D(0x1ae)](c,async e=>{const E=D,F=C;try{await d(e),await(0x0,sleepRandomTime_1[E(0x1a4)])({'minMilliseconds':Number(process['env'][F(0x1a7)]||0x1f4),'maxMilliseconds':Number(process[F(0x194)][E(0x1a3)]||0x7d0)}),this['channel'][F(0x1a9)](e);return;}catch(f){this['channel'][F(0x1b7)](e),logger_1[F(0x1a6)][E(0x19e)]('consumeWhatsapp',f);}});}async[t(0x1ae)](c,d){const G=u;return this[G(0x1aa)]['consume'](c,e=>{const H=G,I=G;if('THlTG'==='yhlJC')this[H(0x1aa)]['nack'](f),g['logger'][I(0x19e)](H(0x1ab),h);else try{d(e),this[I(0x1aa)]['ack'](e);return;}catch(g){if(I(0x19c)!==H(0x19c))return this['channel'][H(0x1ae)](f,p=>{const J=I,K=H;try{k(p),this[J(0x1aa)][J(0x1a9)](p);return;}catch(q){m[J(0x1a6)][K(0x19e)](q);}});else logger_1[I(0x1a6)][I(0x19e)](g);}});}}exports['default']=RabbitmqServer;