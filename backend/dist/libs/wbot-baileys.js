'use strict';const J=b,K=b;(function(c,d){const H=b,I=b,e=c();while(!![]){try{const f=parseInt(H(0x98))/0x1+parseInt(I(0x95))/0x2+parseInt(H(0xc7))/0x3+-parseInt(H(0xb8))/0x4+-parseInt(H(0xe5))/0x5+-parseInt(I(0xa4))/0x6*(parseInt(H(0xce))/0x7)+parseInt(H(0xec))/0x8;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x33f7a));var __createBinding=this&&this[J(0xc5)]||(Object[J(0xa8)]?function(c,d,e,f){const L=K,M=J;if(f===undefined)f=e;var g=Object['getOwnPropertyDescriptor'](d,e);if(!g||(L(0xef)in g?!d[M(0xe2)]:g[M(0x9d)]||g[L(0xc2)])){if(M(0xb9)===M(0xa3)){const i=!!(i[L(0xe0)]||j['templateMessage']||e[M(0xb3)]);return i&&(c={'viewOnceMessageV2':{'message':{'messageContextInfo':{'deviceListMetadataVersion':0x2,'deviceListMetadata':{}},...p}}}),n;}else g={'enumerable':!![],'get':function(){const N=L;if('fcAwr'!=='fcAwr')f['defineProperty'](g,N(0xb7),{'enumerable':!![],'value':h});else return d[e];}};}Object['defineProperty'](c,f,g);}:function(c,d,e,f){if(f===undefined)f=e;c[f]=d[e];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[J(0xa8)]?function(c,d){const O=J;Object[O(0x9f)](c,'default',{'enumerable':!![],'value':d});}:function(c,d){const P=J;c[P(0xb7)]=d;}),__importStar=this&&this[J(0x90)]||function(c){const Q=J,R=K;if(c&&c[Q(0xe2)])return c;var d={};if(c!=null){for(var e in c)if(e!==Q(0xb7)&&Object[Q(0xc8)][Q(0xdd)]['call'](c,e))__createBinding(d,c,e);}return __setModuleDefault(d,c),d;},__importDefault=this&&this[J(0xbb)]||function(c){const S=J;return c&&c[S(0xe2)]?c:{'default':c};};Object[J(0x9f)](exports,K(0xe2),{'value':!![]}),exports[K(0xa1)]=exports['removeWbot']=exports[J(0xae)]=void 0x0;const Sentry=__importStar(require(K(0xe6))),baileys_1=__importStar(require(J(0xcc))),Whatsapp_1=__importDefault(require(J(0x9e))),logger_1=__importDefault(require('@whiskeysockets/baileys/lib/Utils/logger')),useMultiFileAuthState_1=require(J(0x8f)),AppError_1=__importDefault(require(K(0xc3))),node_cache_1=__importDefault(require(K(0x91))),socket_1=require('./socket'),StartWhatsAppSession_1=require(J(0xe4)),cache_1=require(K(0xc6)),loggerBaileys=logger_1[J(0xb7)][K(0xd0)]({}),logger=logger_1[K(0xb7)][J(0xd0)]({});function b(c,d){const e=a();return b=function(f,g){f=f-0x8f;let h=e[f];return h;},b(c,d);}loggerBaileys['level']=K(0xd4);const sessions=[],retriesQrCodeMap=new Map(),getWbot=c=>{const T=K,d=sessions['findIndex'](e=>e['id']===c);if(d===-0x1)throw new AppError_1['default'](T(0xa5));return sessions[d];};exports['getWbot']=getWbot;const removeWbot=async(c,d=!![])=>{const U=J,V=K;try{const e=sessions[U(0xbc)](f=>f['id']===c);if(e!==-0x1){if(V(0xb5)!=='BPABk')g[h][V(0xbd)](),i[j]['ws'][U(0x99)]();else{if(d){if('FhguH'===V(0xe7))sessions[e]['logout'](),sessions[e]['ws'][U(0x99)]();else{if(p===q)r=s;var h=t[V(0xdb)](u,v);(!h||('get'in h?!w['__esModule']:h[U(0x9d)]||h[V(0xc2)]))&&(h={'enumerable':!![],'get':function(){return h[F];}}),z['defineProperty'](A,B,h);}}sessions['splice'](e,0x1);}}}catch(h){V(0xb6)!==U(0xdf)?logger[U(0xd4)](h):((0x0,h[V(0x9c)])(i,![]),j(()=>(0x0,m[U(0xcf)])(n),0x7d0));}};exports[K(0x9c)]=removeWbot;function a(){const a4=['useMultiFileAuthState','cacheLayer','create','user',',\x20isLatest:\x20','lwReg','Session\x20QRCode\x20Generate\x20','set','getWbot','splice','JSVSN','WIjYb','endsWith','listMessage','info','BPABk','NHvKQ','default','1517744ftwCnQ','zVsGv','makeCacheableSignalKeyStore','__importDefault','findIndex','logout','statusCode','emit','EyAjQ','captureException','configurable','../errors/AppError',':whatsappSession','__createBinding','./cache','267606KvThRJ','prototype','tKxqZ','open','Socket\x20\x20','@whiskeysockets/baileys','using\x20WA\x20v','91JWOhnU','StartWhatsAppSession','child','appropriate','qrcode','push','error','creds.update','wLeMo','delete','uDCcr','SxAnv','split','getOwnPropertyDescriptor','TnuGh','hasOwnProperty','keys','ysLMO','buttonsMessage','vjAyy','__esModule','update','../services/WbotServices/StartWhatsAppSession','365755gLakyn','@sentry/node','FhguH','findOne','connection.update','log','tenantId','2055048FIEdex','IpkWf','creds','get','../helpers/useMultiFileAuthState','__importStar','node-cache','Starting\x20session\x20','templateMessage','sessions:','786620nlPFRF','output','getIO','68051kHQxbT','close','delFromPattern','fetchLatestBaileysVersion','removeWbot','writable','../models/Whatsapp','defineProperty','PENDING','initWASocket','readySession','wjnnp','65538zqVhuY','ERR_WAPP_NOT_INITIALIZED'];a=function(){return a4;};return a();}const initWASocket=async c=>{return new Promise(async(d,e)=>{const a2=b,a3=b;try{((async()=>{const W=b,X=b;if(W(0xe1)!==X(0xdc)){const f=(0x0,socket_1[W(0x97)])(),g=await Whatsapp_1['default'][X(0xe8)]({'where':{'id':c['id']}});if(!g)return;const {id:h,name:i}=g,{version:j,isLatest:k}=await(0x0,baileys_1[W(0x9b)])();logger['info'](X(0xcd)+j['join']('.')+X(0xaa)+k),logger[X(0xb4)](X(0x92)+i);let l=0x0,m=null;const {state:n,saveCreds:o}=await(0x0,useMultiFileAuthState_1[W(0xa6)])(c),p=new node_cache_1[(W(0xb7))](),q=new node_cache_1[(W(0xb7))]();m=(0x0,baileys_1[W(0xb7)])({'logger':loggerBaileys,'printQRInTerminal':![],'browser':baileys_1['Browsers'][W(0xd1)]('Desktop'),'auth':{'creds':n[W(0xee)],'keys':(0x0,baileys_1[W(0xba)])(n[W(0xde)],logger)},'version':j,'defaultQueryTimeoutMs':0xea60,'msgRetryCounterCache':p,'generateHighQualityLinkPreview':!![],'userDevicesCache':q,'transactionOpts':{'maxCommitRetries':0x1,'delayBetweenTriesMs':0xa},'shouldSyncHistoryMessage':r=>{return![];},'shouldIgnoreJid':r=>(0x0,baileys_1['isJidBroadcast'])(r)||r?.[W(0xb2)]('@newsletter'),'patchMessageBeforeSending':r=>{const Y=W,Z=X,s=!!(r[Y(0xe0)]||r[Y(0x93)]||r[Y(0xb3)]);return s&&(r={'viewOnceMessageV2':{'message':{'messageContextInfo':{'deviceListMetadataVersion':0x2,'deviceListMetadata':{}},...r}}}),r;}}),m['ev']['on'](W(0xe9),async({connection:r,lastDisconnect:s,qr:t})=>{const a0=X,a1=X;if(a0(0xd8)==='uDCcr'){logger[a1(0xb4)](a0(0xcb)+i+'\x20Connection\x20Update\x20'+(r||'')+'\x20'+(s||''));if(r===a0(0x99)){s?.['error']?.[a1(0x96)]?.[a0(0xbe)]===0x193&&('kzraY'!==a0(0xc0)?(await c[a1(0xe3)]({'status':a0(0xa0),'session':''}),await cache_1[a0(0xa7)][a1(0x9a)]('sessions:'+c['id']+':*'),f[a1(0xbf)](c['tenantId']+':whatsappSession',{'action':a0(0xe3),'session':c}),(0x0,exports[a0(0x9c)])(h,![])):e={'viewOnceMessageV2':{'message':{'messageContextInfo':{'deviceListMetadataVersion':0x2,'deviceListMetadata':{}},...f}}});if(s?.[a1(0xd4)]?.['output']?.[a0(0xbe)]!==baileys_1['DisconnectReason']['loggedOut']){if(a0(0xb1)!==a1(0xb1)){if(k===l)m=n;o[p]=q[r];}else(0x0,exports[a0(0x9c)])(h,![]),setTimeout(()=>(0x0,StartWhatsAppSession_1['StartWhatsAppSession'])(c),0x7d0);}else await c['update']({'status':a1(0xa0),'session':''}),await cache_1[a1(0xa7)][a1(0x9a)](a1(0x94)+c['id']+':*'),f[a1(0xbf)](c['tenantId']+a0(0xc4),{'action':a1(0xe3),'session':c}),(0x0,exports[a1(0x9c)])(h,![]),setTimeout(()=>(0x0,StartWhatsAppSession_1[a1(0xcf)])(c),0x7d0);}if(r===a1(0xca)){const w=m[a0(0xa9)];let x=w['id'][a0(0xda)]('@')[0x0];x=x[a1(0xda)](':')[0x0],await c[a0(0xe3)]({'status':'CONNECTED','qrcode':'','number':x,'retries':0x0}),f['emit'](c[a1(0xeb)]+a1(0xc4),{'action':'update','session':c}),f['emit'](c['tenantId']+a1(0xc4),{'action':a1(0xa2),'session':c});const y=sessions[a0(0xbc)](z=>z['id']===c['id']);y===-0x1&&(a0(0xed)==='LdVTB'?e[a1(0xd4)](f):(m['id']=c['id'],sessions['push'](m))),d(m);}if(t!==undefined){if(a1(0xd6)===a1(0xd6)){if(retriesQrCodeMap[a1(0xef)](h)&&retriesQrCodeMap[a0(0xef)](h)>=0x3)await g['update']({'status':'DISCONNECTED','qrcode':''}),await cache_1[a0(0xa7)][a1(0x9a)](a1(0x94)+c['id']+':*'),f[a0(0xbf)](c[a0(0xeb)]+a1(0xc4),{'action':a1(0xe3),'session':g}),m['ev']['removeAllListeners']('connection.update'),m['ws'][a0(0x99)](),m=null,retriesQrCodeMap[a1(0xd7)](h);else{if(a1(0xc9)!==a0(0xd9)){logger[a1(0xb4)](a0(0xac)+i),retriesQrCodeMap[a1(0xad)](h,l+=0x1),await c['update']({'qrcode':t,'status':a1(0xd2),'retries':0x0});const A=sessions[a1(0xbc)](B=>B['id']===c['id']);A===-0x1&&('qzPVK'!==a1(0xab)?(m['id']=c['id'],sessions[a0(0xd3)](m)):e[a1(0xb7)]=f),f[a0(0xbf)](c[a0(0xeb)]+a1(0xc4),{'action':'update','session':c});}else j&&(q[r][a0(0xbd)](),s[t]['ws']['close']()),o[a1(0xaf)](p,0x1);}}else return e[f];}}else{const F=i[a0(0xbc)](G=>G['id']===o);F!==-0x1&&(o&&(s[F][a1(0xbd)](),t[F]['ws'][a1(0x99)]()),r[a0(0xaf)](F,0x1));}}),m['ev']['on'](X(0xd5),o);}else g['id']=h['id'],i[X(0xd3)](j);})());}catch(f){if('RomGs'===a2(0xb0))return g&&h[a2(0xe2)]?i:{'default':j};else Sentry[a2(0xc1)](f),console[a2(0xea)](f),e(f);}});};exports[K(0xa1)]=initWASocket;