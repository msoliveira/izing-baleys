'use strict';const s=b,t=b;(function(c,d){const q=b,r=b,e=c();while(!![]){try{const f=-parseInt(q(0xeb))/0x1*(-parseInt(q(0x116))/0x2)+-parseInt(q(0x100))/0x3*(-parseInt(q(0x109))/0x4)+-parseInt(r(0x107))/0x5*(parseInt(q(0xfe))/0x6)+parseInt(r(0x106))/0x7+-parseInt(r(0x103))/0x8*(parseInt(q(0xfd))/0x9)+parseInt(q(0x10a))/0xa*(parseInt(q(0xf9))/0xb)+-parseInt(r(0x101))/0xc*(parseInt(q(0xed))/0xd);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xa406d));var __importDefault=this&&this[s(0x10b)]||function(c){return c&&c['__esModule']?c:{'default':c};};function a(){const w=['Transfer','walletId','pending','1656xJOnAt','../../restClients/openIARestClient','14261umjXoP','../../models/ContactWallet','../MessageServices/CreateMessageSystemService','typeMessage','message','parse','sendType','queueId','getBodyMessage','name','OlÃ¡','sendMessageToIA','279763avUexk','contactId','status','defineProperty','304821SXVucZ','6DfAvym','number','9iUzvvx','516MYRnup','default','80NVnVat','../../models/Contact','tenantId','3547901Kqcxiy','1938945BaziAx','answered','808828CWntsv','70MUNMQF','__importDefault','__esModule','isGroup','findByPk','log','../../models/Whatsapp','fromMe','queue_transf','findOne','answer','from_ia','186iIUrVP'];a=function(){return w;};return a();}function b(c,d){const e=a();return b=function(f,g){f=f-0xeb;let h=e[f];return h;},b(c,d);}Object[t(0xfc)](exports,s(0x10c),{'value':!![]});const Contact_1=__importDefault(require(s(0x104))),openIARestClient_1=require(s(0xec)),CreateMessageSystemService_1=__importDefault(require(s(0xef))),Whatsapp_1=__importDefault(require(t(0x110))),UpdateQueueIATicket_1=__importDefault(require('../TicketServices/UpdateQueueIATicket')),ContactWallet_1=__importDefault(require(s(0xee))),VerifyContactBaileys_1=require('../WbotServices/helpers/VerifyContactBaileys'),VerifyMensageOpenIAQueue=async(c,d,e=![],f=![],g,h)=>{const u=t,v=t;if(c[u(0xfb)]===v(0x119)&&!c[u(0x10d)]&&!c[u(0x108)]&&c['is_chat_ia']&&d[u(0x115)]){if(h&&h[u(0x111)])return;const i=await ContactWallet_1[v(0x102)][u(0x113)]({'where':{'contactId':c[v(0xfa)]}});if(!!i){await(0x0,UpdateQueueIATicket_1[v(0x102)])(null,c,i[v(0x118)]);return;}try{const j=await Contact_1[v(0x102)][u(0x10e)](c[v(0xfa)]),k=await Whatsapp_1[v(0x102)][u(0x10e)](c['whatsappId']);let l;if(e)l=await(0x0,openIARestClient_1[v(0xf8)])({'message':{'id':'primeira\x20mensagem','contact_name':j[v(0xf6)],'ticket_id':c['id'],'body':u(0xf7),'sender_number':k[u(0xff)],'receiver_number':j[v(0xff)]}});else{const n=await(0x0,VerifyContactBaileys_1[v(0xf5)])(h);l=await(0x0,openIARestClient_1[v(0xf8)])({'message':{'id':g['id'],'contact_name':j['name'],'ticket_id':c['id'],'body':n,'sender_number':k[u(0xff)],'receiver_number':j[v(0xff)]}});}l=JSON[u(0xf2)](l);const m={'body':l['message'][v(0x114)],'fromMe':!![],'read':!![],'sendType':'bot'};await(0x0,CreateMessageSystemService_1[v(0x102)])({'msg':m,'tenantId':c[v(0x105)],'ticket':c,'sendType':m[v(0xf3)],'status':'pending'});if(l[u(0xf1)][u(0xf0)]==u(0x117)){const o=f?c[v(0xf4)]:k[u(0x112)];await(0x0,UpdateQueueIATicket_1[u(0x102)])(o,c);}}catch(p){console[u(0x10f)](p);}}};exports[t(0x102)]=VerifyMensageOpenIAQueue;