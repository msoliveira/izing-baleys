'use strict';const n=b,p=b;function a(){const s=['request','__importDefault','__esModule','593838DeUahx','932064pchmoZ','timestamp','default','message','../ChatFlowServices/VerifyStepsChatFlowTicket','3044540alpxqI','4LZVivh','./InstagramVerifyMediaMessage','defineProperty','directThread','instagram','user_id','4646656kkqHeW','feed','../WbotServices/helpers/VerifyBusinessHours','thread_id','accountLogin','../TicketServices/FindOrCreateTicketService','text','./InstagramVerifyMessage','isFarewellMessage','2402163NjVJsI','tenantId','entity','item_type','40rVbuPn','./InstagramVerifyContact','63598kvhHpp','7939071ElQCWX'];a=function(){return s;};return a();}(function(c,d){const l=b,m=b,e=c();while(!![]){try{const f=parseInt(l(0xef))/0x1*(-parseInt(m(0xe3))/0x2)+parseInt(m(0xe8))/0x3+parseInt(m(0xd4))/0x4+-parseInt(m(0xee))/0x5+-parseInt(l(0xe9))/0x6+-parseInt(m(0xe4))/0x7+parseInt(l(0xe1))/0x8*(parseInt(m(0xdd))/0x9);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xa3380));function b(c,d){const e=a();return b=function(f,g){f=f-0xd2;let h=e[f];return h;},b(c,d);}var __importDefault=this&&this[n(0xe6)]||function(c){const o=n;return c&&c[o(0xe7)]?c:{'default':c};};Object[p(0xf1)](exports,p(0xe7),{'value':!![]});const VerifyStepsChatFlowTicket_1=__importDefault(require(n(0xed))),FindOrCreateTicketService_1=__importDefault(require(n(0xd9))),VerifyBusinessHours_1=__importDefault(require(n(0xd6))),ShowWhatsAppService_1=__importDefault(require('../WhatsappService/ShowWhatsAppService')),InstagramVerifyContact_1=__importDefault(require(p(0xe2))),InstagramVerifyMediaMessage_1=__importDefault(require(p(0xf0))),InstagramVerifyMessage_1=__importDefault(require(p(0xdb))),handleRealtimeReceive=async(c,d)=>{const q=n,r=n,e=await(0x0,ShowWhatsAppService_1['default'])({'id':d['id']}),f=await d[q(0xd5)]['directThread']({'thread_id':c[q(0xec)][r(0xd7)],'oldest_cursor':''})[q(0xe5)](),g=await(0x0,InstagramVerifyContact_1[q(0xeb)])(f,d,e[q(0xde)]),h=d?.[r(0xd8)],i=h?.['pk']===c['message'][r(0xd3)],j=await(0x0,FindOrCreateTicketService_1['default'])({'contact':g,'whatsappId':d['id'],'unreadMessages':i?0x0:0x1,'tenantId':e[q(0xde)],'msg':{...c['message'],'fromMe':i},'channel':q(0xd2)});if(j?.[q(0xdc)])return;c[q(0xec)][r(0xe0)]!==q(0xda)?await(0x0,InstagramVerifyMediaMessage_1[q(0xeb)])(c,i,j,g):await(0x0,InstagramVerifyMessage_1[r(0xeb)])(c,i,j,g);const k=await d[r(0xdf)][q(0xf2)](c[r(0xec)][r(0xd7)]);k['markItemSeen'](c['message']['item_id']),await(0x0,VerifyStepsChatFlowTicket_1['default'])({'fromMe':i,'body':c['message']?.[r(0xda)]||''},j),await(0x0,VerifyBusinessHours_1[q(0xeb)])({'fromMe':i,'timestamp':c[r(0xec)][r(0xea)]/0x3e8},j);};exports[n(0xeb)]=handleRealtimeReceive;