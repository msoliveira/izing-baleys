'use strict';const I=b,J=b;(function(c,d){const G=b,H=b,e=c();while(!![]){try{const f=-parseInt(G(0xe8))/0x1*(-parseInt(H(0xee))/0x2)+parseInt(H(0xf1))/0x3+parseInt(G(0xeb))/0x4+parseInt(H(0xfd))/0x5*(-parseInt(H(0xe9))/0x6)+parseInt(H(0xf6))/0x7*(-parseInt(H(0x113))/0x8)+parseInt(H(0x104))/0x9+parseInt(H(0xea))/0xa;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x645bb));function b(c,d){const e=a();return b=function(f,g){f=f-0xe4;let h=e[f];return h;},b(c,d);}var __createBinding=this&&this[I(0xff)]||(Object[I(0x106)]?function(c,d,e,f){const K=J,L=I;if(f===undefined)f=e;var g=Object['getOwnPropertyDescriptor'](d,e);if(!g||(K(0xfc)in g?!d['__esModule']:g[K(0xf5)]||g['configurable'])){if(L(0x10b)==='xiPCx')return e[f];else g={'enumerable':!![],'get':function(){return d[e];}};}Object[L(0xf3)](c,f,g);}:function(c,d,e,f){if(f===undefined)f=e;c[f]=d[e];}),__setModuleDefault=this&&this[I(0x100)]||(Object['create']?function(c,d){const M=I,N=I;Object[M(0xf3)](c,M(0xf4),{'enumerable':!![],'value':d});}:function(c,d){c['default']=d;}),__importStar=this&&this['__importStar']||function(c){const O=J,P=J;if(c&&c[O(0x102)])return c;var d={};if(c!=null){for(var e in c)if(e!==O(0xf4)&&Object[O(0x101)]['hasOwnProperty'][P(0x112)](c,e))__createBinding(d,c,e);}return __setModuleDefault(d,c),d;},__importDefault=this&&this[I(0xfa)]||function(c){return c&&c['__esModule']?c:{'default':c};};function a(){const T=['26104BghCVz','UyYnC','update','shape','getOwnPropertyDescriptor','59285NMZfDO','4718736EXrVKe','10142210KXPuOM','697248PVLdvH','map','message','4aZKtzY','profile','queue','733944YJvfxQ','queues','defineProperty','default','writable','1162vKpjBL','amjzm','NBokM','name','__importDefault','../../models/Queue','get','5SCjzOm','destroy','__createBinding','__setModuleDefault','prototype','__esModule','all','1686870uCkkaB','min','create','../../models/User','object','BtbSA','reload','beXUZ','ZkDGl','configurable','email','../../errors/AppError','yup','string','call'];a=function(){return T;};return a();}Object[J(0xf3)](exports,I(0x102),{'value':!![]});const Yup=__importStar(require(I(0x110))),AppError_1=__importDefault(require(I(0x10f))),Queue_1=__importDefault(require(I(0xfb))),User_1=__importDefault(require(J(0x107))),UsersQueues_1=__importDefault(require('../../models/UsersQueues')),UpdateUserService=async({userData:c,userId:d,tenantId:e})=>{const Q=J,R=J,f=await User_1[Q(0xf4)]['findOne']({'where':{'id':d,'tenantId':e},'attributes':[R(0xf9),'id',R(0x10e),R(0xef)]});if(!f){if(Q(0x10c)!==R(0xe4))throw new AppError_1[(Q(0xf4))]('ERR_NO_USER_FOUND',0x194);else{if(k===l)m=n;o[p]=q[r];}}const g=Yup[R(0x108)]()[Q(0xe6)]({'name':Yup[R(0x111)]()[Q(0x105)](0x2),'email':Yup[Q(0x111)]()['email'](),'profile':Yup[Q(0x111)](),'password':Yup[Q(0x111)]()}),{email:h,password:i,profile:j,name:k,queues:l}=c;try{await g['validate']({'email':h,'password':i,'profile':j,'name':k});}catch(o){if(Q(0xf8)===Q(0xf7)){if(p===q)r=s;var q=t[R(0xe7)](u,v);(!q||(Q(0xfc)in q?!w[R(0x102)]:q['writable']||q[Q(0x10d)]))&&(q={'enumerable':!![],'get':function(){return q[F];}}),z[Q(0xf3)](A,B,q);}else throw new AppError_1[(Q(0xf4))](o?.[R(0xed)]);}l&&(R(0x109)===R(0x109)?(await UsersQueues_1[R(0xf4)][R(0xfe)]({'where':{'userId':d}}),await Promise[Q(0x103)](l[Q(0xec)](async q=>{const S=R,r=q?.['id']||q;await UsersQueues_1[S(0xf4)]['upsert']({'queueId':r,'userId':d});}))):f={'enumerable':!![],'get':function(){return i[j];}});await f[R(0xe5)]({'email':h,'password':i,'profile':j,'name':k}),await f[R(0x10a)]({'attributes':['id',R(0xf9),R(0x10e),Q(0xef)],'include':[{'model':Queue_1[R(0xf4)],'attributes':['id',R(0xf0)]}]});const m={'id':f['id'],'name':f[Q(0xf9)],'email':f['email'],'profile':f[Q(0xef)],'queues':f[Q(0xf2)]};return m;};exports[J(0xf4)]=UpdateUserService;