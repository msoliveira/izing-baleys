'use strict';const m=b,o=b;function a(){const r=['6AUjLmN','2326105qEsbPV','createAccessToken','default','../../models/Queue','ERR_INVALID_CREDENTIALS','email','status','4fJyHLD','../../errors/AppError','queues','3177822sXuddk','tenant','3MDICrY','../../models/User','findAll','active','8867184dLmKOY','name','1169104eQVqXZ','6287036AuEYzC','../../helpers/CreateTokens','__esModule','update','lastLogin','__importDefault','345084rIRweN','9srXQtt','5830OFDsqh','1010azHgOv','online'];a=function(){return r;};return a();}(function(c,d){const k=b,l=b,e=c();while(!![]){try{const f=parseInt(k(0x13b))/0x1*(-parseInt(k(0x129))/0x2)+parseInt(k(0x139))/0x3*(-parseInt(l(0x136))/0x4)+parseInt(l(0x12f))/0x5+-parseInt(k(0x12e))/0x6*(-parseInt(l(0x123))/0x7)+-parseInt(l(0x141))/0x8*(-parseInt(k(0x12a))/0x9)+parseInt(l(0x12c))/0xa*(parseInt(k(0x12b))/0xb)+parseInt(k(0x13f))/0xc;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xb104d));function b(c,d){const e=a();return b=function(f,g){f=f-0x123;let h=e[f];return h;},b(c,d);}var __importDefault=this&&this[m(0x128)]||function(c){const n=m;return c&&c[n(0x125)]?c:{'default':c};};Object['defineProperty'](exports,o(0x125),{'value':!![]});const User_1=__importDefault(require(m(0x13c))),AppError_1=__importDefault(require(m(0x137))),CreateTokens_1=require(o(0x124)),Queue_1=__importDefault(require(m(0x132))),Tenant_1=__importDefault(require('../../models/Tenant')),AuthUserService=async({email:c,password:d})=>{const p=m,q=o,e=await User_1[p(0x131)]['findOne']({'where':{'email':c},'include':[{'model':Queue_1['default'],'as':q(0x138)},{'model':Tenant_1[p(0x131)],'as':q(0x13a),'where':{'status':p(0x13e)}}]});if(!e)throw new AppError_1[(p(0x131))](q(0x133),0x191);if(!await e['checkPassword'](d))throw new AppError_1['default']('ERR_INVALID_CREDENTIALS',0x191);const f=(0x0,CreateTokens_1[p(0x130)])(e),g=(0x0,CreateTokens_1['createRefreshToken'])(e);await e[q(0x126)]({'isOnline':!![],'status':p(0x12d),'lastLogin':new Date()});const h=await User_1[p(0x131)][q(0x13d)]({'where':{'tenantId':e['tenantId'],'isOnline':!![]},'attributes':['id',q(0x134),q(0x135),'lastOnline',q(0x140),p(0x127)]});return{'user':e,'token':f,'refreshToken':g,'usuariosOnline':h};};exports['default']=AuthUserService;