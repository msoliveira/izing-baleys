'use strict';const t=b,u=b;(function(c,d){const r=b,s=b,e=c();while(!![]){try{const f=parseInt(r(0x183))/0x1*(parseInt(r(0x190))/0x2)+parseInt(s(0x180))/0x3+parseInt(s(0x184))/0x4+-parseInt(s(0x188))/0x5+parseInt(s(0x19a))/0x6+-parseInt(r(0x192))/0x7+parseInt(s(0x185))/0x8*(-parseInt(s(0x19b))/0x9);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x8e5b2));function b(c,d){const e=a();return b=function(f,g){f=f-0x17e;let h=e[f];return h;},b(c,d);}function a(){const x=['3218832ydXgKE','16mLaNAz','findOne','edited','2799050tkvRjE','defineProperty','Fdplk','ERR_EDITING_WAPP_MSG','../../errors/AppError','ztoII','key','../../helpers/socketEmit','2ZlGvpR','../../helpers/GetTicketWbotBaileys','4096666aZWbpw','default','getTime','../../models/Message','dataJson','update','quotedMsg','ticket','1262796tgYlIZ','83925yaltOs','../../models/Ticket','contact','parse','remoteJid','tenantId','ERR_FINDING_MSG','77649AMsPXz','ticketId','__importDefault','705731ncNvGw'];a=function(){return x;};return a();}var __importDefault=this&&this[t(0x182)]||function(c){return c&&c['__esModule']?c:{'default':c};};Object[t(0x189)](exports,'__esModule',{'value':!![]});const AppError_1=__importDefault(require(u(0x18c))),GetTicketWbotBaileys_1=__importDefault(require(t(0x191))),Message_1=__importDefault(require(u(0x195))),Ticket_1=__importDefault(require(u(0x19c))),socketEmit_1=__importDefault(require(u(0x18f))),EditWhatsAppMessage=async({messageId:c,tenantId:d,body:e})=>{const v=u,w=t;let f;try{f=await Message_1['default'][v(0x186)]({'where':{'messageId':c,'tenantId':d},'include':[{'model':Ticket_1[w(0x193)],'as':v(0x199),'include':['contact']}]});if(!f)throw new AppError_1[(v(0x193))]('No\x20message\x20found\x20with\x20this\x20ID.');}catch(k){if(v(0x18a)===w(0x18a))throw new AppError_1['default'](w(0x17f));else throw new d['default']('ERR_EDITING_WAPP_MSG');}const {ticket:g}=f,h=await(0x0,GetTicketWbotBaileys_1[v(0x193)])(g),i=JSON[v(0x19e)](f[w(0x196)]),j=i['key'][w(0x19f)];try{await h['sendMessage'](j,{'text':e,'edit':i[w(0x18e)]},{});const m=(new Date()[w(0x194)]()-new Date(f['createdAt'])[w(0x194)]())/0xea60;if(m>0xa)throw new AppError_1['default'](v(0x18b));if(f[v(0x187)]!==null)throw new AppError_1['default'](w(0x18b));await f[w(0x197)]({'edited':e});const {ticket:n}=f;(0x0,socketEmit_1[w(0x193)])({'tenantId':n[v(0x17e)],'type':'chat:update','payload':f});const o=await Message_1[w(0x193)][v(0x186)]({'where':{'messageId':c,'tenantId':d},'include':[{'model':Ticket_1['default'],'as':v(0x199),'include':[v(0x19d)]},{'model':Message_1[w(0x193)],'as':w(0x198),'include':[v(0x19d)],'where':{'tenantId':d},'required':![]}]});return{'ticketId':o[v(0x181)],'message':o};}catch(p){if(w(0x18d)!==w(0x18d))throw new d[(v(0x193))](w(0x17f));else throw new AppError_1[(w(0x193))](w(0x18b));}};exports[u(0x193)]=EditWhatsAppMessage;