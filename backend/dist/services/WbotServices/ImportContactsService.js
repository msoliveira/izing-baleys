'use strict';const I=b,L=b;(function(c,d){const G=b,H=b,e=c();while(!![]){try{const f=parseInt(G(0xd0))/0x1*(-parseInt(H(0xcc))/0x2)+parseInt(G(0xbd))/0x3+parseInt(G(0xc5))/0x4+parseInt(H(0xc1))/0x5+parseInt(H(0xb0))/0x6+parseInt(H(0xaa))/0x7*(parseInt(G(0xc6))/0x8)+parseInt(G(0xb4))/0x9*(-parseInt(G(0xab))/0xa);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x49184));var __createBinding=this&&this['__createBinding']||(Object[I(0xb8)]?function(c,d,e,f){const J=I,K=I;if(f===undefined)f=e;var g=Object[J(0xa6)](d,e);if(!g||(J(0xa9)in g?!d[K(0xac)]:g[J(0xd5)]||g[J(0xcb)])){if('qngBx'!=='qngBx'){if(p===q)r=s;var i=t['getOwnPropertyDescriptor'](u,v);(!i||(J(0xa9)in i?!w[J(0xac)]:i[K(0xd5)]||i[J(0xcb)]))&&(i={'enumerable':!![],'get':function(){return i[F];}}),z['defineProperty'](A,B,i);}else g={'enumerable':!![],'get':function(){return d[e];}};}Object[K(0xcd)](c,f,g);}:function(c,d,e,f){if(f===undefined)f=e;c[f]=d[e];}),__setModuleDefault=this&&this[I(0xa8)]||(Object['create']?function(c,d){const M=I,N=L;Object[M(0xcd)](c,N(0xca),{'enumerable':!![],'value':d});}:function(c,d){const O=I;c[O(0xca)]=d;}),__importStar=this&&this[L(0xc2)]||function(c){const P=I,Q=L;if(c&&c[P(0xac)])return c;var d={};if(c!=null){for(var e in c)if(e!==P(0xca)&&Object[Q(0xb1)][Q(0xad)][P(0xba)](c,e))__createBinding(d,c,e);}return __setModuleDefault(d,c),d;},__importDefault=this&&this[I(0xb7)]||function(c){const R=L;return c&&c[R(0xac)]?c:{'default':c};};Object[L(0xcd)](exports,L(0xac),{'value':!![]});const Sentry=__importStar(require(I(0xd4))),wbot_baileys_1=require(L(0xae)),Contact_1=__importDefault(require('../../models/Contact')),logger_1=require(I(0xc3)),ShowBaileysService_1=__importDefault(require('../BaileysServices/ShowBaileysService')),CreateContactService_1=__importDefault(require(I(0xd3))),lodash_1=require(L(0xbe)),Whatsapp_1=__importDefault(require(L(0xc9))),AppError_1=__importDefault(require(I(0xb9))),ImportContactsService=async(c,d)=>{const S=I,T=I,e=(0x0,wbot_baileys_1[S(0xa7)])(d),f=await Whatsapp_1['default']['findByPk'](d);if(f[T(0xa5)]!=T(0xce)){if('cmjwa'!==T(0xd1)){if(k===l)m=n;o[p]=q[r];}else throw new AppError_1[(S(0xca))]('Whatsapp\x20selecionado\x20não\x20esta\x20conectado');}let g;try{const j=await(0x0,ShowBaileysService_1[S(0xca)])(e['id']);g=JSON[T(0xb2)](JSON[T(0xbf)](j[S(0xa3)]));}catch(k){console[S(0xb3)](k),Sentry['captureException'](k),logger_1['logger'][T(0xc4)](T(0xc7)+k);}const h=(0x0,lodash_1['isString'])(g)?JSON[T(0xb2)](g):g;(0x0,lodash_1['isArray'])(h)&&(S(0xd2)===S(0xd2)?h[T(0xd6)](async({id:l,name:m,notify:n})=>{const U=S,V=T;if(l===U(0xcf)||l[V(0xbb)](V(0xc0))==='g.us')return;const o=l[V(0xaf)](/\D/g,''),p=await Contact_1[U(0xca)][V(0xbc)]({'where':{'number':o,'tenantId':c}});if(!p)try{'CNtal'!==U(0xb5)?f[U(0xcd)](g,'default',{'enumerable':!![],'value':h}):await(0x0,CreateContactService_1[U(0xca)])({'number':o,'name':m||n,'tenantId':c});}catch(r){Sentry[V(0xc8)](r),console[V(0xb3)](r),logger_1[V(0xb6)][U(0xa4)]('Não\x20foi\x20possível\x20obter\x20os\x20contatos\x20do\x20WhatsApp\x20do\x20telefone.\x20Erro:\x20'+r);}}):e[T(0xca)]=f);};function b(c,d){const e=a();return b=function(f,g){f=f-0xa3;let h=e[f];return h;},b(c,d);}function a(){const W=['__importDefault','create','../../errors/AppError','call','includes','findOne','952689nRoEQI','lodash','stringify','g.us','2931610OEurhk','__importStar','../../utils/logger','error','1129068TlRqCf','2824rgIpEK','Não\x20foi\x20possível\x20obter\x20os\x20contatos\x20do\x20WhatsApp\x20do\x20telefone.\x20Err:\x20','captureException','../../models/Whatsapp','default','configurable','2aLibSs','defineProperty','CONNECTED','status@broadcast','72007fvJHnv','cmjwa','WynYD','../ContactServices/CreateContactService','@sentry/node','writable','forEach','contacts','warn','status','getOwnPropertyDescriptor','getWbot','__setModuleDefault','get','2877JlaoMc','30ikrWtg','__esModule','hasOwnProperty','../../libs/wbot-baileys','replace','1899036HIabJZ','prototype','parse','log','3829014JPlXAE','CNtal','logger'];a=function(){return W;};return a();}exports['default']=ImportContactsService;