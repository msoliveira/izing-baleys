'use strict';function a(){const t=['reverse','62awXtrj','33112yoWKbi','4432190ePnvkb','31533tXrDez','340270gPIwYl','length','default','findAndCountAll','4SZajJH','__esModule','contact','4154120iRurEW','quotedMsg','7464289YGAcXM','9019758MbcXdV','../TicketServices/ShowTicketService','../../models/MessageOffLine','whatsappId','__importDefault','createdAt','126SCcXOI','../../models/Message','DESC','ERR_NO_TICKET_FOUND','contactId'];a=function(){return t;};return a();}const o=b,q=b;function b(c,d){const e=a();return b=function(f,g){f=f-0xf8;let h=e[f];return h;},b(c,d);}(function(c,d){const m=b,n=b,e=c();while(!![]){try{const f=parseInt(m(0xfc))/0x1+parseInt(n(0xfb))/0x2*(parseInt(n(0xfe))/0x3)+parseInt(m(0x103))/0x4*(parseInt(m(0xfd))/0x5)+-parseInt(m(0x109))/0x6+parseInt(n(0x108))/0x7+-parseInt(m(0x106))/0x8+parseInt(m(0x10f))/0x9*(parseInt(m(0xff))/0xa);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xbae62));var __importDefault=this&&this[o(0x10d)]||function(c){const p=o;return c&&c[p(0x104)]?c:{'default':c};};Object['defineProperty'](exports,o(0x104),{'value':!![]});const AppError_1=__importDefault(require('../../errors/AppError')),Message_1=__importDefault(require(o(0x110))),MessageOffLine_1=__importDefault(require(o(0x10b))),Ticket_1=__importDefault(require('../../models/Ticket')),ShowTicketService_1=__importDefault(require(q(0x10a))),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:c,tenantId:d})=>{const r=q,s=q,e=await(0x0,ShowTicketService_1[r(0x101)])({'id':c,'tenantId':d});if(!e)throw new AppError_1[(r(0x101))](r(0xf8),0x194);const f=0x1e,g=f*(+pageNumber-0x1),{count:h,rows:i}=await Message_1[r(0x101)][s(0x102)]({'limit':f,'include':[r(0x105),{'model':Message_1[s(0x101)],'as':s(0x107),'include':[r(0x105)]},{'model':Ticket_1[s(0x101)],'where':{'queueId':e['queueId'],'contactId':e[r(0xf9)],'whatsappId':e[s(0x10c)],'id':e['id']},'required':!![]}],'offset':g,'order':[[r(0x10e),r(0x111)]]});let j=[];if(+pageNumber===0x1){const {rows:l}=await MessageOffLine_1[r(0x101)][r(0x102)]({'where':{'ticketId':c},'include':['contact',{'model':Message_1['default'],'as':s(0x107),'include':[r(0x105)]}],'order':[[r(0x10e),s(0x111)]]});j=l;}const k=h>g+i[r(0x100)];return{'messages':i[s(0xfa)](),'messagesOffLine':j,'ticket':e,'count':h,'hasMore':k};};exports[o(0x101)]=ListMessagesService;