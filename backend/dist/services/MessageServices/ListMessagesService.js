'use strict';function a(){const t=['default','879090TxAPkO','1655962xkkCDX','DESC','createdAt','103668dsIeRM','whatsappId','../../models/Message','2082gjKJbR','1311760HKwJxf','3ciejwg','contact','../../errors/AppError','contactId','__importDefault','../TicketServices/ShowTicketService','__esModule','12XTEBzw','4767hUULqH','reverse','9FuBLFa','ERR_NO_TICKET_FOUND','110025tbnNdf','findAndCountAll','quotedMsg','227195uxkCky','queueId','16bfbkvH'];a=function(){return t;};return a();}const o=b,q=b;(function(c,d){const m=b,n=b,e=c();while(!![]){try{const f=-parseInt(m(0x83))/0x1+-parseInt(m(0x8b))/0x2*(parseInt(m(0x90))/0x3)+-parseInt(n(0x85))/0x4*(-parseInt(n(0x80))/0x5)+parseInt(m(0x8e))/0x6*(parseInt(n(0x7c))/0x7)+-parseInt(m(0x8f))/0x8+-parseInt(n(0x7e))/0x9*(-parseInt(m(0x87))/0xa)+parseInt(n(0x88))/0xb*(parseInt(m(0x7b))/0xc);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x1d3e3));var __importDefault=this&&this[o(0x78)]||function(c){const p=o;return c&&c[p(0x7a)]?c:{'default':c};};Object['defineProperty'](exports,o(0x7a),{'value':!![]});const AppError_1=__importDefault(require(o(0x76))),Message_1=__importDefault(require(o(0x8d))),MessageOffLine_1=__importDefault(require('../../models/MessageOffLine')),Ticket_1=__importDefault(require('../../models/Ticket')),ShowTicketService_1=__importDefault(require(o(0x79))),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:c,tenantId:d})=>{const r=q,s=o,e=await(0x0,ShowTicketService_1[r(0x86)])({'id':c,'tenantId':d});if(!e)throw new AppError_1['default'](r(0x7f),0x194);const f=0x1e,g=f*(+pageNumber-0x1),{count:h,rows:i}=await Message_1[r(0x86)][r(0x81)]({'limit':f,'include':[r(0x75),{'model':Message_1[r(0x86)],'as':s(0x82),'include':[s(0x75)]},{'model':Ticket_1[s(0x86)],'where':{'queueId':e[s(0x84)],'contactId':e[s(0x77)],'whatsappId':e[s(0x8c)],'id':e['id']},'required':!![]}],'offset':g,'order':[[s(0x8a),r(0x89)]]});let j=[];if(+pageNumber===0x1){const {rows:l}=await MessageOffLine_1[s(0x86)]['findAndCountAll']({'where':{'ticketId':c},'include':[s(0x75),{'model':Message_1['default'],'as':'quotedMsg','include':['contact']}],'order':[['createdAt','DESC']]});j=l;}const k=h>g+i['length'];return{'messages':i[s(0x7d)](),'messagesOffLine':j,'ticket':e,'count':h,'hasMore':k};};function b(c,d){const e=a();return b=function(f,g){f=f-0x75;let h=e[f];return h;},b(c,d);}exports[o(0x86)]=ListMessagesService;