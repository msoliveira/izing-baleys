'use strict';const o=b,p=b;function a(){const s=['ticket:update','__esModule','default','./ShowTicketService','../ContactServices/ShowContactService','create','1309vyoHRz','$create','whatsapp','1896JNFSws','ERR_CREATING_TICKET','3524257TpEWyg','ticket','3KmTXlx','defineProperty','../../helpers/GetDefaultWhatsApp','telegram','2759778JhZceJ','../../errors/AppError','453284WDmmHu','../../helpers/CheckContactOpenTickets','609486ETbfLM','1jccOWI','instagram','810490gVIpwb','1462608yFBTvU','10BhuzFm'];a=function(){return s;};return a();}(function(c,d){const l=b,m=b,e=c();while(!![]){try{const f=-parseInt(l(0x1fd))/0x1*(parseInt(m(0x1fc))/0x2)+-parseInt(m(0x1f4))/0x3*(-parseInt(l(0x1fa))/0x4)+parseInt(m(0x1ff))/0x5+parseInt(m(0x200))/0x6+-parseInt(l(0x208))/0x7*(parseInt(m(0x20b))/0x8)+-parseInt(m(0x1f8))/0x9+-parseInt(m(0x201))/0xa*(-parseInt(m(0x1f2))/0xb);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x2ce3e));var __importDefault=this&&this['__importDefault']||function(c){const n=b;return c&&c[n(0x203)]?c:{'default':c};};Object[o(0x1f5)](exports,o(0x203),{'value':!![]});const AppError_1=__importDefault(require(p(0x1f9))),CheckContactOpenTickets_1=__importDefault(require(o(0x1fb))),GetDefaultWhatsApp_1=__importDefault(require(p(0x1f6))),socketEmit_1=__importDefault(require('../../helpers/socketEmit')),ShowContactService_1=__importDefault(require(p(0x206))),CreateLogTicketService_1=__importDefault(require('./CreateLogTicketService')),ShowTicketService_1=__importDefault(require(p(0x205))),CreateTicketService=async({contactId:c,status:d,userId:e,tenantId:f,channel:g,channelId:channelId=undefined})=>{const q=o,r=o,h=await(0x0,GetDefaultWhatsApp_1['default'])(f,channelId);if(!g||![q(0x1fe),r(0x1f7),q(0x20a)]['includes'](g))throw new AppError_1['default']('ERR_CREATING_TICKET');await(0x0,CheckContactOpenTickets_1[r(0x204)])(c);const {isGroup:i}=await(0x0,ShowContactService_1['default'])({'id':c,'tenantId':f}),{id:j}=await h[r(0x209)](q(0x1f3),{'contactId':c,'status':d,'isGroup':i,'userId':e,'isActiveDemand':!![],'channel':g,'tenantId':f}),k=await(0x0,ShowTicketService_1['default'])({'id':j,'tenantId':f});if(!k)throw new AppError_1[(q(0x204))](q(0x1f1));return await(0x0,CreateLogTicketService_1[q(0x204)])({'userId':e,'ticketId':k['id'],'type':r(0x207)}),(0x0,socketEmit_1[q(0x204)])({'tenantId':f,'type':q(0x202),'payload':k}),k;};function b(c,d){const e=a();return b=function(f,g){f=f-0x1f1;let h=e[f];return h;},b(c,d);}exports[p(0x204)]=CreateTicketService;