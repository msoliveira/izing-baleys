'use strict';const w=b,x=b;(function(c,d){const u=b,v=b,e=c();while(!![]){try{const f=-parseInt(u(0x135))/0x1*(parseInt(u(0x139))/0x2)+-parseInt(u(0x131))/0x3+-parseInt(v(0x133))/0x4*(-parseInt(u(0x118))/0x5)+parseInt(u(0x122))/0x6+parseInt(u(0x10c))/0x7+-parseInt(v(0x115))/0x8*(-parseInt(v(0x12a))/0x9)+parseInt(v(0x127))/0xa*(-parseInt(v(0x123))/0xb);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xf2778));function a(){const G=['11732595neIOId','ewRdN','360_NOT_DOWNLOAD_MEDIA:\x20','RSCNr','video','ERROR\x20DONWLOAD','audio','logger','error','8EpAQAx','createWriteStream','image','8348565rRzvmY','/v1/media/','document','join','defineProperty','jGpVc','public','data','../../utils/logger','tokenAPI','5497224JPWOKt','11ulFeUe','length','split','HxoOh','28223410kfAjNE','filename','__esModule','13748517LpUPCb','../../errors/AppError','stream','default','pipe','voice','Ypdlq','3822006Zdphwi','GET','4dszgDQ','getTime','272IgOyGv','mime_type','axios','path','5148GuasQJ'];a=function(){return G;};return a();}var __importDefault=this&&this['__importDefault']||function(c){return c&&c['__esModule']?c:{'default':c};};Object[w(0x11c)](exports,w(0x129),{'value':!![]});const axios_1=__importDefault(require(x(0x137))),fs_1=require('fs'),path_1=require(w(0x138)),AppError_1=__importDefault(require(w(0x12b))),logger_1=require(x(0x120)),downloadFile=async(c,d,e)=>{const y=w,z=w,f=process['env']['API_URL_360']+y(0x119)+d,g=(0x0,path_1[y(0x11b)])(__dirname,'..','..',z(0x11e),e),h=await(0x0,axios_1[z(0x12d)])({'url':f,'method':y(0x132),'responseType':z(0x12c),'headers':{'D360-API-KEY':c}});await new Promise((i,j)=>{const A=y,B=y;h[A(0x11f)][B(0x12e)]((0x0,fs_1[B(0x116)])(g))['on']('finish',async()=>i(!![]))['on'](B(0x114),k=>{const C=B,D=A;console[C(0x114)](C(0x111),k),j(new Error(k));});});},GetMediaWaba360=async({channel:c,msg:d,ticket:e})=>{const E=x,F=x;try{let f='',g,h;d?.[E(0x11a)]&&('VUEri'!==F(0x11d)?(f=d['document']['id']||'',g=d[E(0x11a)][E(0x128)],h=d[F(0x11a)][E(0x136)]):(i=j['document']['id']||'',k=l[E(0x11a)]['filename'],m=n['document'][E(0x136)]));d?.[E(0x117)]&&(E(0x130)!==E(0x130)?(g=h['audio']['id']||'',i=j['audio']['mime_type']):(f=d[F(0x117)]['id']||'',h=d[F(0x117)][F(0x136)]));if(d?.[E(0x110)]){if(E(0x126)!==F(0x126)){h=i[E(0x12f)]['id']||'';const o=j['voice'][F(0x136)]||'',p=o['split'](';');k=p['length']>0x1?p[0x0]:l[E(0x12f)][E(0x136)];}else f=d[F(0x110)]['id']||'',h=d[F(0x110)][F(0x136)];}if(d?.['voice']){if(E(0x10f)===E(0x10d))return g&&h['__esModule']?i:{'default':j};else{f=d['voice']['id']||'';const p=d['voice'][E(0x136)]||'',q=p[E(0x125)](';');h=q[E(0x124)]>0x1?q[0x0]:d['voice'][F(0x136)];}}d?.[F(0x112)]&&(f=d[F(0x112)]['id']||'',h=d['audio'][F(0x136)]);const i=h?.[F(0x125)]('/')[0x1][F(0x125)](';')[0x0],j=new Date()[F(0x134)](),k=g?g+'_'+e['id']+'_'+f+'_'+j+'.'+i:e['id']+'_'+f+'_'+j+'.'+i;return await downloadFile(c[E(0x121)],f,k),k;}catch(r){logger_1[F(0x113)][F(0x114)](r);throw new AppError_1[(E(0x12d))](E(0x10e)+r);}};function b(c,d){const e=a();return b=function(f,g){f=f-0x10c;let h=e[f];return h;},b(c,d);}exports[w(0x12d)]=GetMediaWaba360;