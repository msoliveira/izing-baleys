'use strict';const m=b,n=b;(function(c,d){const k=b,l=b,e=c();while(!![]){try{const f=parseInt(k(0x131))/0x1*(-parseInt(k(0x12a))/0x2)+-parseInt(l(0x144))/0x3+parseInt(l(0x136))/0x4*(parseInt(k(0x13c))/0x5)+-parseInt(l(0x134))/0x6*(parseInt(k(0x13a))/0x7)+parseInt(l(0x142))/0x8+-parseInt(k(0x130))/0x9+-parseInt(k(0x12d))/0xa*(-parseInt(k(0x135))/0xb);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xba76e));var __importDefault=this&&this[m(0x137)]||function(c){return c&&c['__esModule']?c:{'default':c};};Object[n(0x143)](exports,n(0x132),{'value':!![]});function b(c,d){const e=a();return b=function(f,g){f=f-0x12a;let h=e[f];return h;},b(c,d);}const sequelize_1=require(m(0x13f)),socketEmit_1=__importDefault(require('../../helpers/socketEmit')),Contact_1=__importDefault(require('../../models/Contact')),Message_1=__importDefault(require(n(0x13e))),Ticket_1=__importDefault(require(m(0x140))),MessengerMarkRead=async(c,d)=>{const o=n,p=m,e=await Message_1[o(0x139)][o(0x12b)]({'where':{'tenantId':d,'createdAt':{[sequelize_1['Op'][p(0x133)]]:new Date(c['read']['watermark'])},'fromMe':!![],'ack':{[sequelize_1['Op']['in']]:[0x1,0x2]}},'include':[{'model':Ticket_1['default'],'where':{'tenantId':d},'include':[{'model':Contact_1[o(0x139)],'where':{'tenantId':d,'messengerId':c[o(0x141)]['id']}}]}]});await Promise['all'](e[o(0x12e)](async f=>{const q=p,r=p;await f[q(0x12c)]({'ack':0x3}),(0x0,socketEmit_1[q(0x139)])({'tenantId':d,'type':q(0x13b),'payload':{...f[q(0x12f)],'mediaUrl':f[r(0x138)],'id':f['id'],'timestamp':f[r(0x145)],'messageId':f[q(0x13d)],'status':'sended','ack':0x3}});}));};function a(){const s=['messageId','../../models/Message','sequelize','../../models/Ticket','sender','2857000PVvsrQ','defineProperty','1584933Fsanzp','timestamp','2hfXcSr','findAll','update','3558040dLQYNR','map','dataValues','2619918DuBtcQ','827009KDkXqY','__esModule','lte','2449194sPJczG','88KccWrN','4EFhlZB','__importDefault','mediaUrl','default','14dZRqwz','chat:ack','115105gUCMTW'];a=function(){return s;};return a();}exports[m(0x139)]=MessengerMarkRead;