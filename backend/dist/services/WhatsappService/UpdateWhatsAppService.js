'use strict';const I=b,J=b;function b(c,d){const e=a();return b=function(f,g){f=f-0x1ca;let h=e[f];return h;},b(c,d);}(function(c,d){const G=b,H=b,e=c();while(!![]){try{const f=-parseInt(G(0x1e0))/0x1+parseInt(G(0x1f2))/0x2+parseInt(G(0x1e1))/0x3+-parseInt(H(0x1d0))/0x4*(parseInt(H(0x1e9))/0x5)+-parseInt(G(0x1d4))/0x6+-parseInt(H(0x1db))/0x7*(-parseInt(G(0x1cc))/0x8)+-parseInt(G(0x1ec))/0x9;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x23b46));function a(){const T=['findOne','object','875838sCQRfr','GjBlK','ERR_NO_WAPP_FOUND','WdjOe','string','__importStar','call','873383Ezdhuk','../../errors/AppError','validate','SeBiT','sequelize','106954tNVuxx','766053mMddVF','__importDefault','instagramKey','eIQCq','getOwnPropertyDescriptor','__setModuleDefault','shape','defineProperty','20lsxthJ','yup','not','2014380lVPeEo','configurable','get','__esModule','create','boolean','503192ckcmfH','prototype','min','16aMFdPD','default','../../models/Whatsapp','__createBinding','133492CuFqWe','hasOwnProperty'];a=function(){return T;};return a();}var __createBinding=this&&this[I(0x1cf)]||(Object[I(0x1f0)]?function(c,d,e,f){const K=J,L=I;if(f===undefined)f=e;var g=Object[K(0x1e5)](d,e);(!g||(L(0x1ee)in g?!d['__esModule']:g['writable']||g[L(0x1ed)]))&&(g={'enumerable':!![],'get':function(){return d[e];}}),Object[L(0x1e8)](c,f,g);}:function(c,d,e,f){if(f===undefined)f=e;c[f]=d[e];}),__setModuleDefault=this&&this[I(0x1e6)]||(Object[I(0x1f0)]?function(c,d){const M=J;Object[M(0x1e8)](c,'default',{'enumerable':!![],'value':d});}:function(c,d){const N=I;c[N(0x1cd)]=d;}),__importStar=this&&this[I(0x1d9)]||function(c){const O=I,P=J;if(c&&c['__esModule'])return c;var d={};if(c!=null){for(var e in c)if(e!==O(0x1cd)&&Object[O(0x1ca)][O(0x1d1)][P(0x1da)](c,e))__createBinding(d,c,e);}return __setModuleDefault(d,c),d;},__importDefault=this&&this[I(0x1e2)]||function(c){const Q=J;return c&&c[Q(0x1ef)]?c:{'default':c};};Object['defineProperty'](exports,I(0x1ef),{'value':!![]});const Yup=__importStar(require(J(0x1ea))),sequelize_1=require(J(0x1df)),AppError_1=__importDefault(require(I(0x1dc))),Whatsapp_1=__importDefault(require(I(0x1ce))),UpdateWhatsAppService=async({whatsappData:c,whatsappId:d,tenantId:e})=>{const R=I,S=I,f=Yup[R(0x1d3)]()[S(0x1e7)]({'name':Yup[R(0x1d8)]()[R(0x1cb)](0x2),'isDefault':Yup[R(0x1f1)]()}),{name:g,status:h,isDefault:i,session:j,tokenTelegram:k,instagramUser:l,instagramKey:m,isActive:n,type:o,wabaBSP:p,tokenAPI:q,fbPageId:r,farewellMessage:s,chatFlowId:t,is_open_ia:u,queue_transf:v}=c;try{await f[R(0x1dd)]({'name':g,'status':h,'isDefault':i});let w=null;i&&(R(0x1e4)===R(0x1e4)?(w=await Whatsapp_1[R(0x1cd)]['findOne']({'where':{'isDefault':!![],'tenantId':e,'id':{[sequelize_1['Op'][S(0x1eb)]]:d}}}),w&&('WdjOe'!==R(0x1d7)?e[R(0x1e3)]=f:await w['update']({'isDefault':![]}))):e['default']=f);const x=await Whatsapp_1[R(0x1cd)][R(0x1d2)]({'where':{'id':d,'tenantId':e}});if(!x)throw new AppError_1['default']('ERR_NO_WAPP_FOUND',0x194);const y={'name':g,'status':h,'session':j,'isDefault':i,'tokenTelegram':k,'instagramUser':l,'isActive':n,'type':o,'wabaBSP':p,'tokenAPI':q,'fbPageId':r,'farewellMessage':s,'chatFlowId':t,'is_open_ia':u,'queue_transf':v};if(m){if('SeBiT'===S(0x1de))y[R(0x1e3)]=m;else throw new d[(S(0x1cd))](R(0x1d6),0x194);}return await x['update'](y),{'whatsapp':x,'oldDefaultWhatsapp':w};}catch(C){if(R(0x1d5)!==S(0x1d5)){if(k===l)m=n;o[p]=q[r];}else throw new AppError_1[(S(0x1cd))](C['message']);}};exports['default']=UpdateWhatsAppService;